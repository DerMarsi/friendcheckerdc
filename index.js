(function() { function N(...j){try{let z=globalThis;if(z.vendetta?.metro?.findByProps)return z.vendetta.metro.findByProps(...j);if(z.revenge?.modules?.findByProps)return z.revenge.modules.findByProps(...j);if(z.modules?.find)return z.modules.find((W)=>W&&j.every((E)=>W[E]!==void 0));if(z.webpackChunkdiscord_app);return console.warn(`[ActivityTracker] findByProps failed to find environment for props: ${j.join(", ")}`),null}catch(z){return console.error("[ActivityTracker] findByProps error:",z),null}}var J={log:(j,...z)=>console.log(`[ActivityTracker] ${j}`,...z),warn:(j,...z)=>console.warn(`[ActivityTracker] ${j}`,...z),error:(j,...z)=>console.error(`[ActivityTracker] ${j}`,...z)};var{React:G,stylesheet:f}=N("React","stylesheet","ReactNative"),{ScrollView:L,View:A,Text:_,TouchableOpacity:F,Image:T}=N("ScrollView","View","Text","TouchableOpacity","Image"),{FormSection:R,FormRow:h,FormSwitch:u}=N("FormSection","FormRow"),Q={container:{flex:1,padding:16},header:{fontSize:18,fontWeight:"bold",color:"#fff",marginBottom:10,marginTop:20},emptyText:{color:"#bbb",textAlign:"center",marginVertical:10},logEntry:{backgroundColor:"#2f3136",borderRadius:8,padding:10,marginBottom:8},logTimestamp:{fontSize:12,color:"#b9bbbe",marginBottom:4},logContent:{color:"#dcddde",fontSize:14},friendRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:12,borderBottomWidth:1,borderBottomColor:"#4f545c"},friendName:{color:"#fff",fontSize:16,fontWeight:"500"},removeBtn:{backgroundColor:"#ed4245",paddingHorizontal:12,paddingVertical:6,borderRadius:4},removeBtnText:{color:"#fff",fontSize:12,fontWeight:"bold"},clearBtn:{backgroundColor:"#5865f2",padding:12,borderRadius:4,alignItems:"center",marginTop:20,marginBottom:40},clearBtnText:{color:"#fff",fontWeight:"bold"}};function V({settings:j,storage:z}){let[W,E]=G.useState(0);G.useEffect(()=>{if(!z.targetUserIds)z.targetUserIds=[];if(!z.logs)z.logs=[];E((H)=>H+1)},[]);let Y=(H)=>{z.targetUserIds=z.targetUserIds.filter(($)=>$!==H),E(($)=>$+1)},Z=()=>{z.logs=[],E((H)=>H+1)},O=z.targetUserIds||[],K=(z.logs||[]).slice().reverse();return G.createElement(L,{style:Q.container},G.createElement(_,{style:Q.header},"Close Friends List"),O.length===0?G.createElement(_,{style:Q.emptyText},"No close friends added yet. Go to a user profile and click 'Become a very close friend'."):O.map((H)=>G.createElement(A,{key:H,style:Q.friendRow},G.createElement(_,{style:Q.friendName},`User ID: ${H}`),G.createElement(F,{onPress:()=>Y(H),style:Q.removeBtn},G.createElement(_,{style:Q.removeBtnText},"Remove")))),G.createElement(_,{style:Q.header},"Recent Activity"),K.length===0?G.createElement(_,{style:Q.emptyText},"No activity recorded yet."):K.map((H,$)=>G.createElement(A,{key:$,style:Q.logEntry},G.createElement(_,{style:Q.logTimestamp},new Date(H.timestamp).toLocaleString()),G.createElement(_,{style:Q.logContent},G.createElement(_,{style:{fontWeight:"bold"}},`[${H.type}] `),H.content))),K.length>0&&G.createElement(F,{onPress:Z,style:Q.clearBtn},G.createElement(_,{style:Q.clearBtnText},"Clear Activity Logs")))}var{React:C}=N("React"),U=N("after","before","instead");var X,S,x,M,k=()=>globalThis.vendetta?.plugin?.storage||{},q=(j,z,W)=>{let E=k();if(!E.logs)E.logs=[];if(E.logs.push({timestamp:Date.now(),userId:j,type:z,content:W}),E.logs.length>200)E.logs.shift()},b=(j)=>{if(!(k().targetUserIds||[]).includes(j.user.id))return;let{user:W,status:E}=j,Y=j.client_status?JSON.stringify(j.client_status):"unknown";if(J.log(`[PRESENCE] ${W.id} Status: ${E}`),q(W.id,"PRESENCE",`Status changed to ${E} (${Y})`),j.activities&&j.activities.length>0)j.activities.forEach((Z)=>{q(W.id,"ACTIVITY",`${Z.name}: ${Z.state||""} ${Z.details||""}`)})},D=(j)=>{if(!(k().targetUserIds||[]).includes(j.userId))return;J.log(`[TYPING] ${j.userId} typing in ${j.channelId}`),q(j.userId,"TYPING",`Typing in channel ${j.channelId}`)},m=(j)=>{if(!(k().targetUserIds||[]).includes(j.message.author.id))return;J.log(`[MESSAGE] ${j.message.author.id}: ${j.message.content}`),q(j.message.author.id,"MESSAGE",`Sent message in ${j.channelId}: ${j.message.content}`)},v=(j)=>{if(!(k().targetUserIds||[]).includes(j.userId))return;if(j.channelId)J.log(`[VOICE] ${j.userId} joined ${j.channelId}`),q(j.userId,"VOICE",`Joined/Moved to voice channel ${j.channelId}`);else J.log("[VOICE] Left voice"),q(j.userId,"VOICE","Left voice channel")},l={name:"Activity Tracker",description:"Logs specific user activity to the console",author:"DerMarsi",version:"1.0.0",start:()=>{try{if(J.log("Activity Tracker Plugin Loading..."),X=N("subscribe","dispatch","register"),S=N("getCurrentUser","getUser"),x=N("getStatus","getPresence"),M=N("UserContextMenu"),!X){J.error("Failed to find Dispatcher module!");return}let j=globalThis.vendetta?.patcher||U;if(j&&M)j.after("default",M,([z],W)=>{let E=z.user?.id;if(!E)return;let Y=globalThis.vendetta?.plugin?.storage||{},Z=(Y.targetUserIds||[]).includes(E);if(!W.props.children)W.props.children=[];let{FormRow:O}=N("FormRow"),{View:K,Text:H,TouchableOpacity:$}=N("View","Text","TouchableOpacity");W.props.children.push(C.createElement($,{onPress:()=>{if(!Y.targetUserIds)Y.targetUserIds=[];if(Z)Y.targetUserIds=Y.targetUserIds.filter((B)=>B!==E),J.log(`Removed ${E} from Close Friends.`);else Y.targetUserIds.push(E),J.log(`Added ${E} as Close Friend.`);let{showToast:w}=N("showToast");if(w)w(Z?"Removed from Close Friends":"Added to Close Friends")},style:{padding:12,backgroundColor:Z?"#ed4245":"#248046",borderRadius:4,margin:8}},C.createElement(H,{style:{color:"white",fontWeight:"bold",textAlign:"center"}},Z?"Remove from Close Friends":"Become a very close friend")))});else J.warn("UserContextMenu or Patcher not found, Context Menu button will be missing.");X.subscribe("PRESENCE_UPDATE",b),X.subscribe("TYPING_START",D),X.subscribe("MESSAGE_CREATE",m),X.subscribe("VOICE_STATE_UPDATE",v),J.log("Plugin started!")}catch(j){J.error("FATAL: Failed to start Activity Tracker plugin:",j)}},stop:()=>{try{if(J.log("Activity Tracker Plugin Unloading..."),globalThis.vendetta?.patcher||U)unpatches.forEach((z)=>z());if(X)X.unsubscribe("PRESENCE_UPDATE",b),X.unsubscribe("TYPING_START",D),X.unsubscribe("MESSAGE_CREATE",m),X.unsubscribe("VOICE_STATE_UPDATE",v)}catch(j){J.error("FATAL: Failed to stop Activity Tracker plugin:",j)}},getSettingsPanel:({settings:j})=>{return C.createElement(V,{settings:j,storage:globalThis.vendetta?.plugin?.storage||{}})}};return l;
 })();